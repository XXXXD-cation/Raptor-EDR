# Raptor EDR Agent Configuration
# This file contains the default configuration for the Raptor EDR agent

# Agent identification and basic settings
agent:
  id: ""  # Auto-generated if empty
  name: "raptor-agent"
  version: "1.0.0"
  interval: 30s  # Heartbeat interval
  tags:
    - "production"
    - "linux"

# Server connection settings
server:
  address: "localhost"
  port: 8443
  use_tls: true
  timeout: 30s
  retry_count: 3
  retry_delay: 5s
  health_check: 60s

# Logging configuration
logging:
  level: "info"  # debug, info, warn, error
  format: "json"  # json, console
  output: "stdout"  # stdout, stderr, or file path
  max_size: 100  # MB
  max_backups: 3
  max_age: 28  # days

# Data collection settings
collection:
  process_events: true
  file_events: true
  network_events: true
  registry_events: true  # Windows only
  auth_events: true
  
  # Event batching
  batch_size: 100
  batch_timeout: 5s
  
  # Filtering rules
  filter_rules:
    - name: "exclude_system_processes"
      event_type: "process_create"
      action: "deny"
      condition: "starts_with"
      fields:
        path: "/usr/bin/systemd"
    
    - name: "exclude_temp_files"
      event_type: "file_create"
      action: "deny"
      condition: "contains"
      fields:
        path: "/tmp/"

# Security settings
security:
  cert_file: "/etc/raptor-edr/certs/agent.crt"
  key_file: "/etc/raptor-edr/certs/agent.key"
  ca_file: "/etc/raptor-edr/certs/ca.crt"
  verify_tls: true
  sign_events: true

# Platform-specific settings
linux:
  use_ebpf: true
  ebpf_object_path: "/usr/lib/raptor-edr/ebpf/"
  procfs_path: "/proc"
  sysfs_path: "/sys"
  monitor_paths:
    - "/etc"
    - "/usr/bin"
    - "/usr/sbin"
    - "/home"
    - "/var/log"

windows:
  use_etw: true
  etw_providers:
    - "Microsoft-Windows-Kernel-Process"
    - "Microsoft-Windows-Kernel-File"
    - "Microsoft-Windows-Kernel-Network"
  use_wmi: false
  registry_keys:
    - "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
    - "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce"
    - "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
  monitor_paths:
    - "C:\\Windows\\System32"
    - "C:\\Program Files"
    - "C:\\Users"
  collect_perf_data: false 